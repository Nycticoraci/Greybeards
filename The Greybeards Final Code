/*
   Davey Agrinsoni
   Jacqueline Giggi
   Tuan Nguyen
   Microprocessor II
   Lab 1
*/

const int GREEN = 23;
const int YELLOW = 25;
const int RED = 27;
const int BUZZER = 29;
const int BUTTON = 31;

int buttonstate = HIGH;
int redstate = LOW;

unsigned long previousmil = 0;
const long interval = 500;

int counter = 0;

void setup() {
  Serial.begin(9600);
  pinMode(GREEN, OUTPUT);
  pinMode(YELLOW, OUTPUT);
  pinMode(RED, OUTPUT);
  pinMode(BUZZER, OUTPUT);
  pinMode(BUTTON, INPUT_PULLUP);
}

void loop() {
  unsigned long currentmil = millis();
  if (counter == 0) {
    buttonstate = digitalRead(BUTTON);
  }
  if (buttonstate == LOW) {
    digitalWrite(RED, LOW);
    if (counter == 0) {
      counter = ++counter;
    }
    digitalWrite(RED, HIGH);
    delay(12000);
    tone(BUZZER, 500, 3000);
    delay(3000);
    digitalWrite(RED, LOW);
    digitalWrite(GREEN, HIGH);
    delay(12000);
    tone(BUZZER, 500, 3000);
    delay(3000);
    digitalWrite(GREEN, LOW);
    digitalWrite(YELLOW, HIGH);
    tone(BUZZER, 500, 3000);
    delay(3000);
    digitalWrite(YELLOW, LOW);
    buttonstate = LOW;
  }
  else {
    if (currentmil - previousmil >= interval) {
      previousmil = currentmil;
      if (redstate == LOW) {
        redstate = HIGH;
      }
      else {
        redstate = LOW;
      }
      digitalWrite(RED, redstate);
    }
  }
}
